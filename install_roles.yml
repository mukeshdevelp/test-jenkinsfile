---
- name: Configure EC2 instance via SSM
  hosts: tag_environment_staging
  gather_facts: yes
  connection: aws_ssm   # Use the AWS SSM connection plugin for Ansible
  become: yes
  vars:
    ansible_python_interpreter: /usr/bin/python3

  tasks:
    - name: Install nginx
      package:
        name: nginx
        state: present

    - name: Ensure nginx is running
      service:
        name: nginx
        state: started
